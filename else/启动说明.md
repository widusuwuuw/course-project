# Omnihealth 项目启动说明

## 🚀 快速启动

### 方法一：使用启动脚本（推荐）

1. **启动后端服务**
   ```powershell
   # 在项目根目录执行
   .\start-backend.ps1
   ```

2. **启动前端服务**（新开终端窗口）
   ```powershell
   # 在项目根目录执行
   .\start-frontend.ps1
   ```

### 方法二：手动启动

#### 第一步：启动后端服务
```powershell
# 进入项目目录
cd C:\Users\29845\else\Desktop\course-project

# 激活Python虚拟环境
.\.venv\Scripts\Activate.ps1

# 初始化数据库（首次运行）
python backend\init_db.py

# 启动后端服务（端口8000）
uvicorn app.main:app --reload --app-dir backend --port 8000 --host 127.0.0.1
```

#### 第二步：启动前端应用
```powershell
# 新开终端窗口
cd C:\Users\29845\else\Desktop\course-project\frontend

# 安装依赖（首次运行）
npm install

# 启动Expo开发服务器
npx expo start
```

## 📱 访问地址

- **后端API文档**: http://127.0.0.1:8000/docs
- **前端Expo DevTools**: 启动后在浏览器中显示
- **Web版本**: 通过Expo DevTools启动

## 🔧 配置说明

### 端口配置
- **后端API**: 8000端口
- **前端API连接**: 已配置连接8000端口
- **Expo开发服务器**: 自动分配（通常19000+）

### 数据库
- **开发环境**: SQLite（backend/dev.db）
- **生产环境**: 可配置PostgreSQL

### 环境变量配置
后端配置文件：`backend/.env`
```
DATABASE_URL=sqlite:///./dev.db
SECRET_KEY=your-secret-key
DASHSCOPE_API_KEY=your-dashscope-key
```

## 🎯 功能验证

启动成功后，您可以测试以下功能：

### 1. 用户注册/登录
- 访问前端应用
- 注册新用户或使用示例账户登录

### 2. 健康检测模块
系统支持7大健康模块，共47项医学指标：

| 模块 | 指标数量 | 说明 |
|------|----------|------|
| 血常规检测 | 11项 | 基础血液指标分析 |
| 肝功能检测 | 9项 | 肝功能全面评估 |
| 肾功能检测 | 8项 | 肾功能指标分析 |
| 其他指标 | 1项 | 尿酸检测 |
| **血脂代谢检测** | **7项** | 心血管健康评估 |
| **血糖代谢检测** | **5项** | 糖尿病风险评估 |
| **电解质检测** | **6项** | 水电解质平衡评估 |

### 3. 新增功能亮点
- **智能计算**: HOMA-IR自动计算（血糖和胰岛素输入后）
- **权威参考**: 基于AHA/ACC 2024、ADA 2024等最新医学指南
- **风险分级**: 低/中/高/危急四级风险分类
- **个性化建议**: 根据检测结果提供健康建议

## 📱 真机测试

如需在真机上测试：

1. **确保手机和电脑在同一WiFi网络**
2. **修改前端配置**：
   ```typescript
   // frontend/src/config.ts
   export const API_BASE_URL = 'http://你的电脑IP:8000';
   ```
3. **通过Expo Go扫描二维码**访问应用

## 🛠️ 故障排除

### 常见问题

1. **端口被占用**
   ```
   Error: [Errno 48] Address already in use
   ```
   解决：更换端口或关闭占用端口的程序

2. **Python虚拟环境未激活**
   ```
   'uvicorn' 不是内部或外部命令
   ```
   解决：确保先执行 `.\.venv\Scripts\Activate.ps1`

3. **Node.js版本问题**
   ```
   需要Node.js 16+版本
   ```
   解决：升级Node.js到最新版本

4. **网络连接问题**
   ```
   Failed to connect to API
   ```
   解决：检查后端服务是否正常启动，确认端口配置正确

### 日志查看
- **后端日志**: 终端中显示FastAPI请求日志
- **前端日志**: Expo DevTools中显示详细日志
- **网络请求**: 浏览器开发者工具Network标签

## 📞 技术支持

如遇到问题，请检查：
1. 后端服务是否正常启动（访问 http://127.0.0.1:8000/docs）
2. 前端是否能连接到后端API
3. 浏览器控制台是否有错误信息
4. 确保防火墙允许相应端口通信

---

**🎉 祝您使用愉快！**